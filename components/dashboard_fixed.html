<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéâ –î–∞—à–±–æ—Ä–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
        .container { max-width: 800px; margin: 0 auto; }
        .success { background: #d4edda; padding: 20px; border-radius: 8px; border: 1px solid #c3e6cb; margin: 20px 0; }
        .info { background: #d1ecf1; padding: 15px; border-radius: 8px; border: 1px solid #bee5eb; margin: 15px 0; }
        .test-result { background: white; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #007bff; }
        button { padding: 12px 24px; margin: 10px 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #0056b3; }
        .dashboard-btn { background: #28a745; font-weight: bold; }
        .dashboard-btn:hover { background: #218838; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéâ –î–∞—à–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω!</h1>
        
        <div class="success">
            <h3>‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:</h3>
            <ul>
                <li>–ó–∞–º–µ–Ω–µ–Ω –ø—Ä–æ–±–ª–µ–º–Ω—ã–π analytics.php –Ω–∞ —Ä–∞–±–æ—á—É—é –≤–µ—Ä—Å–∏—é</li>
                <li>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON –∑–∞–ø—Ä–æ—Å–æ–≤</li>
                <li>–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</li>
                <li>–£–ª—É—á—à–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –¥–∞—à–±–æ—Ä–¥–æ–º</li>
            </ul>
        </div>
        
        <div class="info">
            <h3>üß™ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:</h3>
            <button onclick="testAPI()">–¢–µ—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –∏–¥–µ–π</button>
            <button onclick="testStats()">–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>
            <button onclick="testCharts()">–¢–µ—Å—Ç –≥—Ä–∞—Ñ–∏–∫–æ–≤</button>
        </div>
        
        <div id="testResults"></div>
        
        <div style="text-align: center; margin: 30px 0;">
            <button class="dashboard-btn" onclick="window.open('admin.html', '_blank')">
                üöÄ –û–¢–ö–†–´–¢–¨ –î–ê–®–ë–û–†–î
            </button>
            <br><br>
            <a href="fix_dashboard.html" style="color: #6c757d;">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ</a>
        </div>
        
        <div class="info">
            <h4>üìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –¥–∞—à–±–æ—Ä–¥–µ:</h4>
            <ol>
                <li>–¢–∞–±–ª–∏—Ü–∞ –∏–¥–µ–π –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</li>
                <li>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ü–∏—Ñ—Ä—ã</li>
                <li>–ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è (–≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ—Å—Ç—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ)</li>
                <li>–ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12)</li>
            </ol>
        </div>
    </div>

    <script>
        async function testAPI() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<div class="test-result">–¢–µ—Å—Ç–∏—Ä—É—é API —Ç–∞–±–ª–∏—Ü—ã –∏–¥–µ–π...</div>';
            
            try {
                const response = await fetch('./analytics.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'ideas_table' })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    results.innerHTML = '<div class="test-result">‚úÖ <strong>–¢–∞–±–ª–∏—Ü–∞ –∏–¥–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç!</strong><br>–ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: ' + 
                                       (data.pagination ? data.pagination.total : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ') + '</div>';
                } else {
                    results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞') + '</div>';
                }
            } catch (error) {
                results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message + '</div>';
            }
        }
        
        async function testStats() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<div class="test-result">–¢–µ—Å—Ç–∏—Ä—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...</div>';
            
            try {
                const response = await fetch('./analytics.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'stats' })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.data;
                    results.innerHTML = '<div class="test-result">‚úÖ <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!</strong><br>' +
                                       '–í—Å–µ–≥–æ –∏–¥–µ–π: ' + stats.total_ideas.value + '<br>' +
                                       '–í —Ä–∞–±–æ—Ç–µ: ' + stats.ideas_in_progress.value + '<br>' +
                                       '–ü—Ä–∏–Ω—è—Ç–æ: ' + stats.ideas_approved.value + '</div>';
                } else {
                    results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞') + '</div>';
                }
            } catch (error) {
                results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message + '</div>';
            }
        }
        
        async function testCharts() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<div class="test-result">–¢–µ—Å—Ç–∏—Ä—É—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤...</div>';
            
            try {
                const response = await fetch('./analytics.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'charts' })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    results.innerHTML = '<div class="test-result">‚úÖ <strong>–î–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç!</strong><br>' +
                                       '–î–æ—Å—Ç—É–ø–Ω—ã: Timeline, Status, Categories, User Activity</div>';
                } else {
                    results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞') + '</div>';
                }
            } catch (error) {
                results.innerHTML = '<div class="test-result">‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message + '</div>';
            }
        }
    </script>
</body>
</html>